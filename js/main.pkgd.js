!function(){"use strict";function c(n){return new Function("d","return {"+n.map(function(n,r){return JSON.stringify(n)+": d["+r+"]"}).join(",")+"}")}function n(u){var r=new RegExp('["'+u+"\n]"),p=u.charCodeAt(0);function t(o,n){var r,u,i={},a={},t=[],c=o.length,l=0,e=0;function f(){if(c<=l)return a;if(u)return u=!1,i;var n,r=l;if(34===o.charCodeAt(r)){for(var t=r;t++<c;)if(34===o.charCodeAt(t)){if(34!==o.charCodeAt(t+1))break;++t}return l=t+2,13===(n=o.charCodeAt(t+1))?(u=!0,10===o.charCodeAt(t+2)&&++l):10===n&&(u=!0),o.slice(r+1,t).replace(/""/g,'"')}for(;l<c;){var e=1;if(10===(n=o.charCodeAt(l++)))u=!0;else if(13===n)u=!0,10===o.charCodeAt(l)&&(++l,++e);else if(n!==p)continue;return o.slice(r,l-e)}return o.slice(r)}for(;(r=f())!==a;){for(var s=[];r!==i&&r!==a;)s.push(r),r=f();n&&null==(s=n(s,e++))||t.push(s)}return t}function e(n){return n.map(i).join(u)}function i(n){return null==n?"":r.test(n+="")?'"'+n.replace(/\"/g,'""')+'"':n}return{parse:function(n,u){var i,a,r=t(n,function(n,r){if(i)return i(n,r-1);var t,e,o;a=n,i=u?(e=u,o=c(t=n),function(n,r){return e(o(n),r,t)}):c(n)});return r.columns=a,r},parseRows:t,format:function(n,t){var r,e,o;return null==t&&(r=n,e=Object.create(null),o=[],r.forEach(function(n){for(var r in n)r in e||o.push(e[r]=r)}),t=o),[t.map(i).join(u)].concat(n.map(function(r){return t.map(function(n){return i(r[n])}).join(u)})).join("\n")},formatRows:function(n){return n.map(e).join("\n")}}}var r=n(","),t=r.parse,e=r.parseRows,o=r.format,u=r.formatRows,i=n("\t"),a=i.parse,l=i.parseRows,f=i.format,s=i.formatRows,y=Object.freeze({dsvFormat:n,csvParse:t,csvParseRows:e,csvFormat:o,csvFormatRows:u,tsvParse:a,tsvParseRows:l,tsvFormat:f,tsvFormatRows:s}),g=function(n,r){return w(n,r).val},p=function(n,r){var t=w(n=n.trim(),r);if(null===t.val)return null;var e=w(n,r,t.regex);if(null===e.val)return null;if(t.raw+e.raw!==n)return null;return t.dim?function(n,r,t){if("N"===t||"S"===t)return[n,r];if("W"===t||"E"===t)return[r,n]}(t.val,e.val,t.dim):[t.val,e.val]},v=m,h=function(n){return m(n.lat,"lat")+" "+m(n.lon,"lon")},d=b;function m(n,r){var t=b(n,r);return t.whole+"° "+(t.minutes?t.minutes+"' ":"")+(t.seconds?t.seconds+'" ':"")+t.dir}function b(n,r){var t=({lat:["N","S"],lon:["E","W"]}[r]||"")[0<=n?0:1],e=Math.abs(n),o=Math.floor(e),u=60*(e-o),i=Math.floor(u);return{whole:o,minutes:i,seconds:Math.floor(60*(u-i)),dir:t}}function w(n,r,t){if(r||(r="NSEW"),"string"!=typeof n)return{val:null,regex:t};var e=(t=t||/[\s\,]*([\-|\—|\―]?[0-9.]+)°? *(?:([0-9.]+)['’′‘] *)?(?:([0-9.]+)(?:''|"|”|″) *)?([NSEW])?/gi).exec(n);return e?e[4]&&-1===r.indexOf(e[4])?{val:null,regex:t}:{val:((e[1]?parseFloat(e[1]):0)+(e[2]?parseFloat(e[2])/60:0)+(e[3]?parseFloat(e[3])/3600:0))*(e[4]&&"S"===e[4]||"W"===e[4]?-1:1),regex:t,raw:e[0],dim:e[4]}:{val:null,regex:t}}g.pair=p,g.format=v,g.formatPair=h,g.coordToDMS=d;var j=/(Lat)(itude)?/gi,x=/(L)(on|ng)(gitude)?/i;function A(n,r){var t,e,o;for(var u in n)(e=u.match(r))&&(!t||e[0].length/u.length>o)&&(o=e[0].length/u.length,t=u);return t}function _(n){return A(n,j)}function k(n){return A(n,x)}function F(n){return"object"==typeof n?Object.keys(n).length:0}function O(o){var u=[];return[",",";","\t","|"].forEach(function(n){var r=y.dsvFormat(n).parse(o);if(1<=r.length){for(var t=F(r[0]),e=0;e<r.length;e++)if(F(r[e])!==t)return;u.push({delimiter:n,arity:Object.keys(r[0]).length})}}),u.length?u.sort(function(n,r){return r.arity-n.arity})[0].delimiter:null}var S={isLon:function(n){return!!n.match(x)},isLat:function(n){return!!n.match(j)},guessLatHeader:_,guessLonHeader:k,csv:y.csvParse,tsv:y.tsvParse,dsv:y,auto:function(n){var r,t=O(n);return t?(delete(r=y.dsvFormat(t).parse(n)).columns,r):null},csv2geojson:function(n,r,t){t||(t=r,r={}),r.delimiter=r.delimiter||",";var e=r.latfield||"",o=r.lonfield||"",u=r.crs||"",i=[],a={type:"FeatureCollection",features:i};if(""!==u&&(a.crs={type:"name",properties:{name:u}}),"auto"!==r.delimiter||"string"!=typeof n||(r.delimiter=O(n),r.delimiter)){var c="string"==typeof n?y.dsvFormat(r.delimiter).parse(n):n;if(c.length){var l,f=[];if(e||(e=_(c[0])),o||(o=k(c[0])),e&&o){for(l=0;l<c.length;l++)if(void 0!==c[l][o]&&void 0!==c[l][e]){var s,p,v,h=c[l][o],d=c[l][e];(v=g(h,"EW"))&&(h=v),(v=g(d,"NS"))&&(d=v),s=parseFloat(h),p=parseFloat(d),isNaN(s)||isNaN(p)?f.push({message:"A row contained an invalid value for latitude or longitude",row:c[l],index:l}):(r.includeLatLon||(delete c[l][o],delete c[l][e]),i.push({type:"Feature",properties:c[l],geometry:{type:"Point",coordinates:[parseFloat(s),parseFloat(p)]}}))}t(f.length?f:null,a)}else{for(l=0;l<c.length;l++)i.push({type:"Feature",properties:c[l],geometry:null});t(f.length?f:null,a)}}else t(null,a)}else t({type:"Error",message:"Could not autodetect delimiter"})},toLine:function(n){for(var r=n.features,t={type:"Feature",geometry:{type:"LineString",coordinates:[]}},e=0;e<r.length;e++)t.geometry.coordinates.push(r[e].geometry.coordinates);return t.properties=r.reduce(function(n,r){for(var t in r.properties)n[t]||(n[t]=[]),n[t].push(r.properties[t]);return n},{}),{type:"FeatureCollection",features:[t]}},toPolygon:function(n){for(var r=n.features,t={type:"Feature",geometry:{type:"Polygon",coordinates:[[]]}},e=0;e<r.length;e++)t.geometry.coordinates[0].push(r[e].geometry.coordinates);return t.properties=r.reduce(function(n,r){for(var t in r.properties)n[t]||(n[t]=[]),n[t].push(r.properties[t]);return n},{}),{type:"FeatureCollection",features:[t]}}};var $="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};var E,M=(function(V,X){!function(){var n="object"==typeof self&&self.self===self&&self||"object"==typeof $&&$.global===$&&$||this||{},r=n._,e=Array.prototype,i=Object.prototype,s="undefined"!=typeof Symbol?Symbol.prototype:null,o=e.push,c=e.slice,p=i.toString,u=i.hasOwnProperty,t=Array.isArray,a=Object.keys,l=Object.create,f=function(){},v=function(n){return n instanceof v?n:this instanceof v?void(this._wrapped=n):new v(n)};X.nodeType?n._=v:(!V.nodeType&&V.exports&&(X=V.exports=v),X._=v),v.VERSION="1.9.0";var h,d=function(o,u,n){if(void 0===u)return o;switch(null==n?3:n){case 1:return function(n){return o.call(u,n)};case 3:return function(n,r,t){return o.call(u,n,r,t)};case 4:return function(n,r,t,e){return o.call(u,n,r,t,e)}}return function(){return o.apply(u,arguments)}},y=function(n,r,t){return v.iteratee!==h?v.iteratee(n,r):null==n?v.identity:v.isFunction(n)?d(n,r,t):v.isObject(n)&&!v.isArray(n)?v.matcher(n):v.property(n)};v.iteratee=h=function(n,r){return y(n,r,1/0)};var g=function(o,u){return u=null==u?o.length-1:+u,function(){for(var n=Math.max(arguments.length-u,0),r=Array(n),t=0;t<n;t++)r[t]=arguments[t+u];switch(u){case 0:return o.call(this,r);case 1:return o.call(this,arguments[0],r);case 2:return o.call(this,arguments[0],arguments[1],r)}var e=Array(u+1);for(t=0;t<u;t++)e[t]=arguments[t];return e[u]=r,o.apply(this,e)}},m=function(n){if(!v.isObject(n))return{};if(l)return l(n);f.prototype=n;var r=new f;return f.prototype=null,r},b=function(r){return function(n){return null==n?void 0:n[r]}},w=function(n,r){for(var t=r.length,e=0;e<t;e++){if(null==n)return;n=n[r[e]]}return t?n:void 0},j=Math.pow(2,53)-1,x=b("length"),A=function(n){var r=x(n);return"number"==typeof r&&0<=r&&r<=j};v.each=v.forEach=function(n,r,t){var e,o;if(r=d(r,t),A(n))for(e=0,o=n.length;e<o;e++)r(n[e],e,n);else{var u=v.keys(n);for(e=0,o=u.length;e<o;e++)r(n[u[e]],u[e],n)}return n},v.map=v.collect=function(n,r,t){r=y(r,t);for(var e=!A(n)&&v.keys(n),o=(e||n).length,u=Array(o),i=0;i<o;i++){var a=e?e[i]:i;u[i]=r(n[a],a,n)}return u};var _=function(c){return function(n,r,t,e){var o=3<=arguments.length;return function(n,r,t,e){var o=!A(n)&&v.keys(n),u=(o||n).length,i=0<c?0:u-1;for(e||(t=n[o?o[i]:i],i+=c);0<=i&&i<u;i+=c){var a=o?o[i]:i;t=r(t,n[a],a,n)}return t}(n,d(r,e,4),t,o)}};v.reduce=v.foldl=v.inject=_(1),v.reduceRight=v.foldr=_(-1),v.find=v.detect=function(n,r,t){var e=(A(n)?v.findIndex:v.findKey)(n,r,t);if(void 0!==e&&-1!==e)return n[e]},v.filter=v.select=function(n,e,r){var o=[];return e=y(e,r),v.each(n,function(n,r,t){e(n,r,t)&&o.push(n)}),o},v.reject=function(n,r,t){return v.filter(n,v.negate(y(r)),t)},v.every=v.all=function(n,r,t){r=y(r,t);for(var e=!A(n)&&v.keys(n),o=(e||n).length,u=0;u<o;u++){var i=e?e[u]:u;if(!r(n[i],i,n))return!1}return!0},v.some=v.any=function(n,r,t){r=y(r,t);for(var e=!A(n)&&v.keys(n),o=(e||n).length,u=0;u<o;u++){var i=e?e[u]:u;if(r(n[i],i,n))return!0}return!1},v.contains=v.includes=v.include=function(n,r,t,e){return A(n)||(n=v.values(n)),("number"!=typeof t||e)&&(t=0),0<=v.indexOf(n,r,t)},v.invoke=g(function(n,t,e){var o,u;return v.isFunction(t)?u=t:v.isArray(t)&&(o=t.slice(0,-1),t=t[t.length-1]),v.map(n,function(n){var r=u;if(!r){if(o&&o.length&&(n=w(n,o)),null==n)return;r=n[t]}return null==r?r:r.apply(n,e)})}),v.pluck=function(n,r){return v.map(n,v.property(r))},v.where=function(n,r){return v.filter(n,v.matcher(r))},v.findWhere=function(n,r){return v.find(n,v.matcher(r))},v.max=function(n,e,r){var t,o,u=-1/0,i=-1/0;if(null==e||"number"==typeof e&&"object"!=typeof n[0]&&null!=n)for(var a=0,c=(n=A(n)?n:v.values(n)).length;a<c;a++)null!=(t=n[a])&&u<t&&(u=t);else e=y(e,r),v.each(n,function(n,r,t){o=e(n,r,t),(i<o||o===-1/0&&u===-1/0)&&(u=n,i=o)});return u},v.min=function(n,e,r){var t,o,u=1/0,i=1/0;if(null==e||"number"==typeof e&&"object"!=typeof n[0]&&null!=n)for(var a=0,c=(n=A(n)?n:v.values(n)).length;a<c;a++)null!=(t=n[a])&&t<u&&(u=t);else e=y(e,r),v.each(n,function(n,r,t){((o=e(n,r,t))<i||o===1/0&&u===1/0)&&(u=n,i=o)});return u},v.shuffle=function(n){return v.sample(n,1/0)},v.sample=function(n,r,t){if(null==r||t)return A(n)||(n=v.values(n)),n[v.random(n.length-1)];var e=A(n)?v.clone(n):v.values(n),o=x(e);r=Math.max(Math.min(r,o),0);for(var u=o-1,i=0;i<r;i++){var a=v.random(i,u),c=e[i];e[i]=e[a],e[a]=c}return e.slice(0,r)},v.sortBy=function(n,e,r){var o=0;return e=y(e,r),v.pluck(v.map(n,function(n,r,t){return{value:n,index:o++,criteria:e(n,r,t)}}).sort(function(n,r){var t=n.criteria,e=r.criteria;if(t!==e){if(e<t||void 0===t)return 1;if(t<e||void 0===e)return-1}return n.index-r.index}),"value")};var k=function(i,r){return function(e,o,n){var u=r?[[],[]]:{};return o=y(o,n),v.each(e,function(n,r){var t=o(n,r,e);i(u,n,t)}),u}};v.groupBy=k(function(n,r,t){v.has(n,t)?n[t].push(r):n[t]=[r]}),v.indexBy=k(function(n,r,t){n[t]=r}),v.countBy=k(function(n,r,t){v.has(n,t)?n[t]++:n[t]=1});var F=/[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g;v.toArray=function(n){return n?v.isArray(n)?c.call(n):v.isString(n)?n.match(F):A(n)?v.map(n,v.identity):v.values(n):[]},v.size=function(n){return null==n?0:A(n)?n.length:v.keys(n).length},v.partition=k(function(n,r,t){n[t?0:1].push(r)},!0),v.first=v.head=v.take=function(n,r,t){if(!(null==n||n.length<1))return null==r||t?n[0]:v.initial(n,n.length-r)},v.initial=function(n,r,t){return c.call(n,0,Math.max(0,n.length-(null==r||t?1:r)))},v.last=function(n,r,t){if(!(null==n||n.length<1))return null==r||t?n[n.length-1]:v.rest(n,Math.max(0,n.length-r))},v.rest=v.tail=v.drop=function(n,r,t){return c.call(n,null==r||t?1:r)},v.compact=function(n){return v.filter(n,Boolean)};var O=function(n,r,t,e){for(var o=(e=e||[]).length,u=0,i=x(n);u<i;u++){var a=n[u];if(A(a)&&(v.isArray(a)||v.isArguments(a)))if(r)for(var c=0,l=a.length;c<l;)e[o++]=a[c++];else O(a,r,t,e),o=e.length;else t||(e[o++]=a)}return e};v.flatten=function(n,r){return O(n,r,!1)},v.without=g(function(n,r){return v.difference(n,r)}),v.uniq=v.unique=function(n,r,t,e){v.isBoolean(r)||(e=t,t=r,r=!1),null!=t&&(t=y(t,e));for(var o=[],u=[],i=0,a=x(n);i<a;i++){var c=n[i],l=t?t(c,i,n):c;r&&!t?(i&&u===l||o.push(c),u=l):t?v.contains(u,l)||(u.push(l),o.push(c)):v.contains(o,c)||o.push(c)}return o},v.union=g(function(n){return v.uniq(O(n,!0,!0))}),v.intersection=function(n){for(var r=[],t=arguments.length,e=0,o=x(n);e<o;e++){var u=n[e];if(!v.contains(r,u)){var i;for(i=1;i<t&&v.contains(arguments[i],u);i++);i===t&&r.push(u)}}return r},v.difference=g(function(n,r){return r=O(r,!0,!0),v.filter(n,function(n){return!v.contains(r,n)})}),v.unzip=function(n){for(var r=n&&v.max(n,x).length||0,t=Array(r),e=0;e<r;e++)t[e]=v.pluck(n,e);return t},v.zip=g(v.unzip),v.object=function(n,r){for(var t={},e=0,o=x(n);e<o;e++)r?t[n[e]]=r[e]:t[n[e][0]]=n[e][1];return t};var S=function(u){return function(n,r,t){r=y(r,t);for(var e=x(n),o=0<u?0:e-1;0<=o&&o<e;o+=u)if(r(n[o],o,n))return o;return-1}};v.findIndex=S(1),v.findLastIndex=S(-1),v.sortedIndex=function(n,r,t,e){for(var o=(t=y(t,e,1))(r),u=0,i=x(n);u<i;){var a=Math.floor((u+i)/2);t(n[a])<o?u=a+1:i=a}return u};var E=function(u,i,a){return function(n,r,t){var e=0,o=x(n);if("number"==typeof t)0<u?e=0<=t?t:Math.max(t+o,e):o=0<=t?Math.min(t+1,o):t+o+1;else if(a&&t&&o)return n[t=a(n,r)]===r?t:-1;if(r!=r)return 0<=(t=i(c.call(n,e,o),v.isNaN))?t+e:-1;for(t=0<u?e:o-1;0<=t&&t<o;t+=u)if(n[t]===r)return t;return-1}};v.indexOf=E(1,v.findIndex,v.sortedIndex),v.lastIndexOf=E(-1,v.findLastIndex),v.range=function(n,r,t){null==r&&(r=n||0,n=0),t||(t=r<n?-1:1);for(var e=Math.max(Math.ceil((r-n)/t),0),o=Array(e),u=0;u<e;u++,n+=t)o[u]=n;return o},v.chunk=function(n,r){if(null==r||r<1)return[];for(var t=[],e=0,o=n.length;e<o;)t.push(c.call(n,e,e+=r));return t};var M=function(n,r,t,e,o){if(!(e instanceof r))return n.apply(t,o);var u=m(n.prototype),i=n.apply(u,o);return v.isObject(i)?i:u};v.bind=g(function(r,t,e){if(!v.isFunction(r))throw new TypeError("Bind must be called on a function");var o=g(function(n){return M(r,o,t,this,e.concat(n))});return o}),v.partial=g(function(o,u){var i=v.partial.placeholder,a=function(){for(var n=0,r=u.length,t=Array(r),e=0;e<r;e++)t[e]=u[e]===i?arguments[n++]:u[e];for(;n<arguments.length;)t.push(arguments[n++]);return M(o,a,this,this,t)};return a}),(v.partial.placeholder=v).bindAll=g(function(n,r){var t=(r=O(r,!1,!1)).length;if(t<1)throw new Error("bindAll must be passed function names");for(;t--;){var e=r[t];n[e]=v.bind(n[e],n)}}),v.memoize=function(e,o){var u=function(n){var r=u.cache,t=""+(o?o.apply(this,arguments):n);return v.has(r,t)||(r[t]=e.apply(this,arguments)),r[t]};return u.cache={},u},v.delay=g(function(n,r,t){return setTimeout(function(){return n.apply(null,t)},r)}),v.defer=v.partial(v.delay,v,1),v.throttle=function(t,e,o){var u,i,a,c,l=0;o||(o={});var f=function(){l=!1===o.leading?0:v.now(),u=null,c=t.apply(i,a),u||(i=a=null)},n=function(){var n=v.now();l||!1!==o.leading||(l=n);var r=e-(n-l);return i=this,a=arguments,r<=0||e<r?(u&&(clearTimeout(u),u=null),l=n,c=t.apply(i,a),u||(i=a=null)):u||!1===o.trailing||(u=setTimeout(f,r)),c};return n.cancel=function(){clearTimeout(u),l=0,u=i=a=null},n},v.debounce=function(t,e,o){var u,i,a=function(n,r){u=null,r&&(i=t.apply(n,r))},n=g(function(n){if(u&&clearTimeout(u),o){var r=!u;u=setTimeout(a,e),r&&(i=t.apply(this,n))}else u=v.delay(a,e,this,n);return i});return n.cancel=function(){clearTimeout(u),u=null},n},v.wrap=function(n,r){return v.partial(r,n)},v.negate=function(n){return function(){return!n.apply(this,arguments)}},v.compose=function(){var t=arguments,e=t.length-1;return function(){for(var n=e,r=t[e].apply(this,arguments);n--;)r=t[n].call(this,r);return r}},v.after=function(n,r){return function(){if(--n<1)return r.apply(this,arguments)}},v.before=function(n,r){var t;return function(){return 0<--n&&(t=r.apply(this,arguments)),n<=1&&(r=null),t}},v.once=v.partial(v.before,2),v.restArguments=g;var N=!{toString:null}.propertyIsEnumerable("toString"),L=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],R=function(n,r){var t=L.length,e=n.constructor,o=v.isFunction(e)&&e.prototype||i,u="constructor";for(v.has(n,u)&&!v.contains(r,u)&&r.push(u);t--;)(u=L[t])in n&&n[u]!==o[u]&&!v.contains(r,u)&&r.push(u)};v.keys=function(n){if(!v.isObject(n))return[];if(a)return a(n);var r=[];for(var t in n)v.has(n,t)&&r.push(t);return N&&R(n,r),r},v.allKeys=function(n){if(!v.isObject(n))return[];var r=[];for(var t in n)r.push(t);return N&&R(n,r),r},v.values=function(n){for(var r=v.keys(n),t=r.length,e=Array(t),o=0;o<t;o++)e[o]=n[r[o]];return e},v.mapObject=function(n,r,t){r=y(r,t);for(var e=v.keys(n),o=e.length,u={},i=0;i<o;i++){var a=e[i];u[a]=r(n[a],a,n)}return u},v.pairs=function(n){for(var r=v.keys(n),t=r.length,e=Array(t),o=0;o<t;o++)e[o]=[r[o],n[r[o]]];return e},v.invert=function(n){for(var r={},t=v.keys(n),e=0,o=t.length;e<o;e++)r[n[t[e]]]=t[e];return r},v.functions=v.methods=function(n){var r=[];for(var t in n)v.isFunction(n[t])&&r.push(t);return r.sort()};var I=function(c,l){return function(n){var r=arguments.length;if(l&&(n=Object(n)),r<2||null==n)return n;for(var t=1;t<r;t++)for(var e=arguments[t],o=c(e),u=o.length,i=0;i<u;i++){var a=o[i];l&&void 0!==n[a]||(n[a]=e[a])}return n}};v.extend=I(v.allKeys),v.extendOwn=v.assign=I(v.keys),v.findKey=function(n,r,t){r=y(r,t);for(var e,o=v.keys(n),u=0,i=o.length;u<i;u++)if(r(n[e=o[u]],e,n))return e};var T,P,C=function(n,r,t){return r in t};v.pick=g(function(n,r){var t={},e=r[0];if(null==n)return t;v.isFunction(e)?(1<r.length&&(e=d(e,r[1])),r=v.allKeys(n)):(e=C,r=O(r,!1,!1),n=Object(n));for(var o=0,u=r.length;o<u;o++){var i=r[o],a=n[i];e(a,i,n)&&(t[i]=a)}return t}),v.omit=g(function(n,t){var r,e=t[0];return v.isFunction(e)?(e=v.negate(e),1<t.length&&(r=t[1])):(t=v.map(O(t,!1,!1),String),e=function(n,r){return!v.contains(t,r)}),v.pick(n,e,r)}),v.defaults=I(v.allKeys,!0),v.create=function(n,r){var t=m(n);return r&&v.extendOwn(t,r),t},v.clone=function(n){return v.isObject(n)?v.isArray(n)?n.slice():v.extend({},n):n},v.tap=function(n,r){return r(n),n},v.isMatch=function(n,r){var t=v.keys(r),e=t.length;if(null==n)return!e;for(var o=Object(n),u=0;u<e;u++){var i=t[u];if(r[i]!==o[i]||!(i in o))return!1}return!0},T=function(n,r,t,e){if(n===r)return 0!==n||1/n==1/r;if(null==n||null==r)return!1;if(n!=n)return r!=r;var o=typeof n;return("function"===o||"object"===o||"object"==typeof r)&&P(n,r,t,e)},P=function(n,r,t,e){n instanceof v&&(n=n._wrapped),r instanceof v&&(r=r._wrapped);var o=p.call(n);if(o!==p.call(r))return!1;switch(o){case"[object RegExp]":case"[object String]":return""+n==""+r;case"[object Number]":return+n!=+n?+r!=+r:0==+n?1/+n==1/r:+n==+r;case"[object Date]":case"[object Boolean]":return+n==+r;case"[object Symbol]":return s.valueOf.call(n)===s.valueOf.call(r)}var u="[object Array]"===o;if(!u){if("object"!=typeof n||"object"!=typeof r)return!1;var i=n.constructor,a=r.constructor;if(i!==a&&!(v.isFunction(i)&&i instanceof i&&v.isFunction(a)&&a instanceof a)&&"constructor"in n&&"constructor"in r)return!1}e=e||[];for(var c=(t=t||[]).length;c--;)if(t[c]===n)return e[c]===r;if(t.push(n),e.push(r),u){if((c=n.length)!==r.length)return!1;for(;c--;)if(!T(n[c],r[c],t,e))return!1}else{var l,f=v.keys(n);if(c=f.length,v.keys(r).length!==c)return!1;for(;c--;)if(l=f[c],!v.has(r,l)||!T(n[l],r[l],t,e))return!1}return t.pop(),e.pop(),!0},v.isEqual=function(n,r){return T(n,r)},v.isEmpty=function(n){return null==n||(A(n)&&(v.isArray(n)||v.isString(n)||v.isArguments(n))?0===n.length:0===v.keys(n).length)},v.isElement=function(n){return!(!n||1!==n.nodeType)},v.isArray=t||function(n){return"[object Array]"===p.call(n)},v.isObject=function(n){var r=typeof n;return"function"===r||"object"===r&&!!n},v.each(["Arguments","Function","String","Number","Date","RegExp","Error","Symbol","Map","WeakMap","Set","WeakSet"],function(r){v["is"+r]=function(n){return p.call(n)==="[object "+r+"]"}}),v.isArguments(arguments)||(v.isArguments=function(n){return v.has(n,"callee")});var B=n.document&&n.document.childNodes;"function"!=typeof/./&&"object"!=typeof Int8Array&&"function"!=typeof B&&(v.isFunction=function(n){return"function"==typeof n||!1}),v.isFinite=function(n){return!v.isSymbol(n)&&isFinite(n)&&!isNaN(parseFloat(n))},v.isNaN=function(n){return v.isNumber(n)&&isNaN(n)},v.isBoolean=function(n){return!0===n||!1===n||"[object Boolean]"===p.call(n)},v.isNull=function(n){return null===n},v.isUndefined=function(n){return void 0===n},v.has=function(n,r){if(!v.isArray(r))return null!=n&&u.call(n,r);for(var t=r.length,e=0;e<t;e++){var o=r[e];if(null==n||!u.call(n,o))return!1;n=n[o]}return!!t},v.noConflict=function(){return n._=r,this},v.identity=function(n){return n},v.constant=function(n){return function(){return n}},v.noop=function(){},v.property=function(r){return v.isArray(r)?function(n){return w(n,r)}:b(r)},v.propertyOf=function(r){return null==r?function(){}:function(n){return v.isArray(n)?w(r,n):r[n]}},v.matcher=v.matches=function(r){return r=v.extendOwn({},r),function(n){return v.isMatch(n,r)}},v.times=function(n,r,t){var e=Array(Math.max(0,n));r=d(r,t,1);for(var o=0;o<n;o++)e[o]=r(o);return e},v.random=function(n,r){return null==r&&(r=n,n=0),n+Math.floor(Math.random()*(r-n+1))},v.now=Date.now||function(){return(new Date).getTime()};var W={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},q=v.invert(W),z=function(r){var t=function(n){return r[n]},n="(?:"+v.keys(r).join("|")+")",e=RegExp(n),o=RegExp(n,"g");return function(n){return n=null==n?"":""+n,e.test(n)?n.replace(o,t):n}};v.escape=z(W),v.unescape=z(q),v.result=function(n,r,t){v.isArray(r)||(r=[r]);var e=r.length;if(!e)return v.isFunction(t)?t.call(n):t;for(var o=0;o<e;o++){var u=null==n?void 0:n[r[o]];void 0===u&&(u=t,o=e),n=v.isFunction(u)?u.call(n):u}return n};var K=0;v.uniqueId=function(n){var r=++K+"";return n?n+r:r},v.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var D=/(.)^/,G={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},H=/\\|'|\r|\n|\u2028|\u2029/g,J=function(n){return"\\"+G[n]};v.template=function(u,n,r){!n&&r&&(n=r),n=v.defaults({},n,v.templateSettings);var t,e=RegExp([(n.escape||D).source,(n.interpolate||D).source,(n.evaluate||D).source].join("|")+"|$","g"),i=0,a="__p+='";u.replace(e,function(n,r,t,e,o){return a+=u.slice(i,o).replace(H,J),i=o+n.length,r?a+="'+\n((__t=("+r+"))==null?'':_.escape(__t))+\n'":t?a+="'+\n((__t=("+t+"))==null?'':__t)+\n'":e&&(a+="';\n"+e+"\n__p+='"),n}),a+="';\n",n.variable||(a="with(obj||{}){\n"+a+"}\n"),a="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+a+"return __p;\n";try{t=new Function(n.variable||"obj","_",a)}catch(n){throw n.source=a,n}var o=function(n){return t.call(this,n,v)},c=n.variable||"obj";return o.source="function("+c+"){\n"+a+"}",o},v.chain=function(n){var r=v(n);return r._chain=!0,r};var U=function(n,r){return n._chain?v(r).chain():r};v.mixin=function(t){return v.each(v.functions(t),function(n){var r=v[n]=t[n];v.prototype[n]=function(){var n=[this._wrapped];return o.apply(n,arguments),U(this,r.apply(v,n))}}),v},v.mixin(v),v.each(["pop","push","reverse","shift","sort","splice","unshift"],function(r){var t=e[r];v.prototype[r]=function(){var n=this._wrapped;return t.apply(n,arguments),"shift"!==r&&"splice"!==r||0!==n.length||delete n[0],U(this,n)}}),v.each(["concat","join","slice"],function(n){var r=e[n];v.prototype[n]=function(){return U(this,r.apply(this._wrapped,arguments))}}),v.prototype.value=function(){return this._wrapped},v.prototype.valueOf=v.prototype.toJSON=v.prototype.value,v.prototype.toString=function(){return String(this._wrapped)}}()}(E={exports:{}},E.exports),E.exports),N=(M._,["#f0c","#fc0","#0fc","#0cf","#cf0","#0cf","#f0c","#fc0","#0fc","#0cf","#cf0","#0cf"]);var R,I,T,P,C=new L.StamenTileLayer("terrain"),B=new L.Map("map",{center:new L.LatLng(40.7270841,-73.9691309),zoom:12});B.addLayer(C),R=function(n,r){var t;n?console.error(n):(r.features.forEach(function(n){n.properties.labelGroup=n.properties.group.split("|")[0]}),t=r.features,M.chain(t).map(function(n){return n.properties.group.split("|")}).flatten().uniq().value().forEach(function(n,r){for(var t=r;N.length<t;)t-=N.length;W[n]={color:N[t],icon:L.divIcon({className:"group-"+t+" marker-icon"})}}),t.forEach(function(r){var n,t,e,o;L.marker(r.geometry.coordinates.slice().reverse(),{icon:W[r.properties.labelGroup].icon}).on("click",function(n){window.open(r.properties.link)}).on("mouseover",function(n){this.openPopup()}).on("mouseout",function(n){this.closePopup()}).bindPopup('\n      <div class="popup-banner" style="background-color:'+W[r.properties.labelGroup].color+";color:"+(t=W[r.properties.labelGroup].color,e=4===t.length?""+t.charAt(1)+t.charAt(1)+t.charAt(2)+t.charAt(2)+t.charAt(3)+t.charAt(3):t.substring(1,7),o=[parseInt(e.substring(0,2),16)/255,parseInt(e.substring(2,4),16)/255,parseInt(e.substring(4,6),16)/255].map(function(n){return n<=.03928?n/12.92:Math.pow((n+.055)/1.055,2.4)}),.179<.2126*o[0]+.7152*o[1]+.0722*o[2]?"#000":"#fff")+'">\n        '+(n=r.properties.group,n.replace(/\|/g," + "))+'\n      </div>\n      <div class="popup-title">'+r.properties.title+'</div>\n      <div class="popup-dek">'+r.properties.dek+'</div>\n      <div class="popup-address">\n        <a href="'+r.properties.link+'" rel="noopener" target="_blank">\n          '+r.properties.address.replace(",","<br/>")+"\n        </a>\n      </div>\n    ").addTo(B)}))},I="data/spots.csv",T=function(n,r){n?console.error(n):S.csv2geojson(r,{latfield:"lat",lonfield:"lng"},function(n,r){n?R(n):R(null,r)})},(P=new XMLHttpRequest).open("GET",I,!0),P.onload=function(){if(200<=P.status&&P.status<400){var n=P.responseText;T(null,n)}else T(new Error("File loading error"))},P.onerror=function(){T(new Error("Connection error"))},P.send();var W={}}();
